# User Queries
query GetUserByEmail($email: String!) @auth(level: PUBLIC) {
  users(where: { email: { eq: $email } }) {
    id
    name
    email
    createdAt
  }
}

query GetUser($userId: UUID!) @auth(level: PUBLIC) {
  user(id: $userId) {
    id
    name
    email
    createdAt
  }
}

# Paper Queries
query ListPapers($userId: UUID!) @auth(level: PUBLIC) {
  papers(where: { userId: { eq: $userId } }, orderBy: { createdAt: DESC }) {
    id
    title
    authors
    year
    paperType
    abstract
    arxivId
    ingestionStatus
    citationCount
    createdAt
    pdfUrl
  }
}

query GetPaper($paperId: UUID!) @auth(level: PUBLIC) {
  paper(id: $paperId) {
    id
    title
    authors
    year
    paperType
    abstract
    arxivId
    ingestionStatus
    citationCount
    createdAt
    pdfUrl
  }
}

query SearchPapers($userId: UUID!, $searchTerm: String!) @auth(level: PUBLIC) {
  papers(
    where: {
      _and: [
        { userId: { eq: $userId } }
        {
          _or: [
            { title: { contains: $searchTerm } }
            { abstract: { contains: $searchTerm } }
          ]
        }
      ]
    }
  ) {
    id
    title
    authors
    year
    abstract
    arxivId
    ingestionStatus
  }
}

# Chat Session Queries
query ListChatSessions($userId: UUID!) @auth(level: PUBLIC) {
  chatSessions(where: { userId: { eq: $userId } }, orderBy: { updatedAt: DESC }) {
    id
    title
    userId
    createdAt
    updatedAt
  }
}

query GetChatSession($sessionId: UUID!) @auth(level: PUBLIC) {
  chatSession(id: $sessionId) {
    id
    title
    userId
    createdAt
    updatedAt
  }
}

query GetChatsForSession($sessionId: UUID!) @auth(level: PUBLIC) {
  chats(where: { chatSessionId: { eq: $sessionId } }, orderBy: { createdAt: ASC }) {
    id
    content
    response
    createdAt
  }
}

query GetChatPapersForChat($chatId: UUID!) @auth(level: PUBLIC) {
  chatPapers(where: { chatId: { eq: $chatId } }) {
    paper {
      id
      title
      arxivId
    }
  }
}

# Code Links Queries
query GetCodeLinksForPaper($paperId: UUID!) @auth(level: PUBLIC) {
  codeLinks(where: { paperId: { eq: $paperId } }) {
    id
    url
    repositoryName
  }
}
