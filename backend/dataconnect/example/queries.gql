# Example queries for Research Paper Analysis schema

# Public list of papers
query ListPapers($pageSize: Int = 20, $offset: Int = 0)
  @auth(level: PUBLIC, insecureReason: "Public discovery of papers") {
  papers(limit: $pageSize, offset: $offset, orderBy: { createdAt: DESC }) {
    id
    title
    year
    citationCount
    ingestionStatus
  }
}

# Current user's curated papers
query MyPapers @auth(level: USER) {
  user(key: { id_expr: "auth.uid" }) {
    id
    name
    email
    curated: userPapers_on_user {
      paper {
        id
        title
        year
      }
    }
  }
}

# Paper details including codebase and recent commits
query GetPaper($id: UUID!)
  @auth(level: PUBLIC, insecureReason: "Paper details are public") {
  paper(id: $id) {
    id
    title
    authors
    year
    abstract
    citationCount
    codebase: codebase_on_paper {
      repositoryUrl
      isLinked
      lastSyncedAt
      commits_on_codebase(limit: 10, orderBy: { date: DESC }) {
        sha
        message
        author
        date
      }
    }
    codeLinks: codeLinks_on_paper {
      url
    }
  }
}
